<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…ØªØ¬Ø± Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {font-family: Arial, sans-serif; margin: 0; background: #f7faf7; color: #1f2937;}
    header {background: #fff; padding: 10px 20px; border-bottom: 1px solid #e5efe3; position: sticky; top: 0;}
    .navbar {display: flex; justify-content: space-between; align-items: center;}
    .nav-links {list-style: none; display: flex; gap: 15px; margin: 0; padding: 0;}
    .nav-links a {text-decoration: none; color: #333; padding: 5px 10px; border-radius: 6px;}
    .nav-links a:hover {background: #eaf4e4;}
    .section {padding: 20px;}
    .grid {display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;}
    .card {background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); text-align: center;}
    .card img {max-width: 100%; border-radius: 8px;}
    .btn {background: #7BB661; color: #fff; border: none; padding: 8px 12px; margin-top: 10px; cursor: pointer; border-radius: 6px;}
    .btn:hover {background: #6AA153;}
    table {width: 100%; border-collapse: collapse; margin-top: 10px;}
    th, td {border: 1px solid #ddd; padding: 8px; text-align: center;}
    th {background: #f0f6ee;}
    footer {background: #f0f6ee; text-align: center; padding: 10px; margin-top: 20px;}
    /* Chat */
    .chat-box {position: fixed; bottom: 20px; right: 20px; width: 250px; background: #fff; border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); display: none; flex-direction: column;}
    .chat-header {background: #7BB661; color: #fff; padding: 10px; border-radius: 10px 10px 0 0;}
    .chat-body {padding: 10px; font-size: 14px; height: 150px; overflow-y: auto;}
    .chat-input {display: flex;}
    .chat-input input {flex: 1; padding: 8px; border: none; border-top: 1px solid #ddd;}
    .chat-input button {background: #7BB661; border: none; color: #fff; padding: 8px; cursor: pointer;}
    .chat-toggle {position: fixed; bottom: 20px; right: 20px; background: #7BB661; color: #fff; border: none; border-radius: 50%; width: 50px; height: 50px; cursor: pointer; font-size: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);}
  </style>
</head>
<body>
  <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
  <header>
    <nav class="navbar">
      <div class="logo">ğŸ¥œ Ù…ØªØ¬Ø± Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª</div>
      <ul class="nav-links">
        <li><a href="#types">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª</a></li>
        <li><a href="#about">Ù…Ù† Ù†Ø­Ù†</a></li>
        <li><a href="#cart">Ø§Ù„Ø³Ù„Ø©</a></li>
        <li><a href="#shop">Ø§Ù„Ø´Ø±Ø§Ø¡</a></li>
      </ul>
    </nav>
  </header>

  <!-- Ø§Ù„Ø£Ù‚Ø³Ø§Ù… -->
  <section id="types" class="section">
    <h2>Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª</h2>
    <div class="grid">
      <!-- Ø¨Ø·Ø§Ù‚Ø© Ù…Ø¹ ÙƒÙ…ÙŠØ© ÙˆØ²Ø± Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© -->
      <div class="card" data-id="p1" data-name="ÙØ³ØªÙ‚ Ù…Ø­Ù…Ù‘Øµ" data-price="18">
        <img src="https://images.unsplash.com/photo-1575550959106-5a7defe28b56?q=80&w=600" alt="ÙØ³ØªÙ‚">
        <h3>ÙØ³ØªÙ‚ Ù…Ø­Ù…Ù‘Øµ</h3>
        <p class="price">â‚ª 18 / 100Øº</p>
        <label>Ø§Ù„ÙƒÙ…ÙŠØ© (Øº): <input type="number" min="100" step="50" value="100" class="qty"></label>
        <button class="add-to-cart">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
      </div>
      <div class="card" data-id="p2" data-name="Ù„ÙˆØ² Ù…Ù…ØªØ§Ø²" data-price="14">
        <img src="https://images.unsplash.com/photo-1601493700631-2f96f598a9a0?q=80&w=600" alt="Ù„ÙˆØ²">
        <h3>Ù„ÙˆØ² Ù…Ù…ØªØ§Ø²</h3>
        <p class="price">â‚ª 14 / 100Øº</p>
        <label>Ø§Ù„ÙƒÙ…ÙŠØ© (Øº): <input type="number" min="100" step="50" value="100" class="qty"></label>
        <button class="add-to-cart">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
      </div>
      <div class="card" data-id="p3" data-name="ÙƒØ§Ø¬Ùˆ Ù…Ø§Ù„Ø­" data-price="22">
        <img src="https://images.unsplash.com/photo-1615486511421-c37a6c63d3e9?q=80&w=600" alt="ÙƒØ§Ø¬Ùˆ">
        <h3>ÙƒØ§Ø¬Ùˆ Ù…Ø§Ù„Ø­</h3>
        <p class="price">â‚ª 22 / 100Øº</p>
        <label>Ø§Ù„ÙƒÙ…ÙŠØ© (Øº): <input type="number" min="100" step="50" value="100" class="qty"></label>
        <button class="add-to-cart">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
      </div>
    </div>
  </section>

  <!-- Ø§Ù„Ø³Ù„Ø© -->
  <section id="cart" class="section">
    <h2>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h2>
    <div class="cart-wrap">
      <table id="cartTable" style="width:100%;border-collapse:collapse">
        <thead>
          <tr>
            <th style="text-align:start;padding:8px;border-bottom:1px solid #eee">Ø§Ù„Ù…Ù†ØªØ¬</th>
            <th style="text-align:start;padding:8px;border-bottom:1px solid #eee">Ø§Ù„Ø³Ø¹Ø±/100Øº</th>
            <th style="text-align:start;padding:8px;border-bottom:1px solid #eee">Ø§Ù„ÙƒÙ…ÙŠØ© (Øº)</th>
            <th style="text-align:start;padding:8px;border-bottom:1px solid #eee">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
            <th></th>
          </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
          <tr>
            <td colspan="3" style="padding:8px;text-align:start;font-weight:bold">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td>
            <td id="cartTotal" style="padding:8px;font-weight:bold">â‚ª 0</td>
            <td></td>
          </tr>
        </tfoot>
      </table>
      <div class="cart-actions" style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
        <button id="clearCart">ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©</button>
        <button id="checkoutCOD">Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</button>
        <button id="checkoutWA">Ø¥ØªÙ…Ø§Ù… Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
      </div>
    </div>
  </section>

  <!-- Ù…Ù† Ù†Ø­Ù† -->
  <section id="about" class="section">
    <h2>Ù…Ù† Ù†Ø­Ù†</h2>
    <p>Ù†Ø­Ù† Ù…ØªØ¬Ø± Ù…ØªØ®ØµØµ Ø¨Ø¨ÙŠØ¹ Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª Ø§Ù„Ø·Ø§Ø²Ø¬Ø© Ø¨Ø£ÙØ¶Ù„ Ø¬ÙˆØ¯Ø©ØŒ Ù…Ø¹ Ø®Ø¯Ù…Ø© ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹Ø©.</p>
  </section>

  <!-- Ø§Ù„Ø´Ø±Ø§Ø¡ -->
  <section id="shop" class="section">
    <h2>Ø§Ù„Ø´Ø±Ø§Ø¡</h2>
    <form onsubmit="sendOrder(event)">
      <input type="text" id="name" placeholder="Ø§Ù„Ø§Ø³Ù…" required>
      <input type="tel" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required>
      <textarea id="address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"></textarea>
      <button type="submit">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
    </form>
  </section>

  <!-- Ø¯Ø¹Ù… Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© -->
  <button class="chat-toggle" onclick="toggleChat()">ğŸ’¬</button>
  <div class="chat-box" id="chat">
    <div class="chat-header">Ø¯Ø¹Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
    <div class="chat-body" id="chatBody">Ù…Ø±Ø­Ø¨Ù‹Ø§! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŸ</div>
    <div class="chat-input">
      <input id="chatInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ...">
      <button onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
  </div>

  <footer>
    <p>Â© 2025 Ù…ØªØ¬Ø± Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª</p>
  </footer>

  <script>
    let cart = [];

    function addToCart(name, price) {
      let item = cart.find(p => p.name === name);
      if(item){ item.qty++; } else { cart.push({name, price, qty:1}); }
      renderCart();
    }

    function renderCart(){
      const tbody = document.querySelector('#cartTable tbody');
      tbody.innerHTML = '';
      let total = 0;
      cart.forEach((item,i)=>{
        let row = `<tr>
          <td>${item.name}</td>
          <td>â‚ª ${item.price}</td>
          <td>${item.qty}</td>
          <td>â‚ª ${item.price*item.qty}</td>
          <td><button onclick="removeItem(${i})">âŒ</button></td>
        </tr>`;
        tbody.innerHTML += row;
        total += item.price*item.qty;
      });
      document.getElementById('total').textContent = total;
    }

    function removeItem(i){ cart.splice(i,1); renderCart(); }

    function sendOrder(e){
      e.preventDefault();
      const name = document.getElementById('name').value;
      const phone = document.getElementById('phone').value;
      const address = document.getElementById('address').value;
      let orderDetails = cart.map(item => `${item.name} Ã— ${item.qty}`).join("\n");
      let msg = `Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† ${name}\nÙ‡Ø§ØªÙ: ${phone}\nØ¹Ù†ÙˆØ§Ù†: ${address}\n---\n${orderDetails}`;
      window.open(`https://wa.me/9647000000000?text=${encodeURIComponent(msg)}`,'_blank');
    }

    function toggleChat(){
      const chat = document.getElementById('chat');
      chat.style.display = (chat.style.display==='flex')?'none':'flex';
      chat.style.flexDirection = 'column';
    }

    function sendMsg(){
      const input = document.getElementById('chatInput');
      if(!input.value) return;
      const body = document.getElementById('chatBody');
      body.innerHTML += `<div>ğŸ‘¤ ${input.value}</div>`;
      input.value = '';
      setTimeout(()=>{ body.innerHTML += `<div>ğŸ¤– Ø´ÙƒØ±Ù‹Ø§ Ù„ØªÙˆØ§ØµÙ„Ùƒ Ù…Ø¹Ù†Ø§</div>`; },500);
    }
  </script>
  <script>
    // === Ø³Ù„Ø© Ø¨Ø³ÙŠØ·Ø© Ù…Ø¹ Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ ÙˆØ­Ø³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ ===
    const CART_KEY = 'nuts_cart_v1';
    const WA_NUMBER = '9647000000000'; // â† Ø¹Ø¯Ù‘Ù„ Ø±Ù‚Ù…Ùƒ Ø¨Ø¯ÙˆÙ† +

    const D = (sel, ctx=document)=>ctx.querySelector(sel);
    const DA = (sel, ctx=document)=>Array.from(ctx.querySelectorAll(sel));

    function money(v){ return `â‚ª ${v.toLocaleString('ar-IQ')}`; }

    function getCart(){ try{return JSON.parse(localStorage.getItem(CART_KEY)||'[]')}catch{return []} }
    function setCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); renderCart(); }

    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù†Ø§ØµØ± Ù„Ù„Ø³Ù„Ø©
    DA('.add-to-cart').forEach(btn=>{
      btn.addEventListener('click', e=>{
        const card = e.target.closest('.card');
        const id = card.dataset.id;
        const name = card.dataset.name;
        const price100 = parseFloat(card.dataset.price); // Ø³Ø¹Ø± Ù„ÙƒÙ„ 100Øº
        const grams = parseInt(D('.qty', card).value||100,10);
        const item = {id,name,price100,grams,qty:1};
        const cart = getCart();
        const idx = cart.findIndex(x=>x.id===id && x.grams===grams);
        if(idx>-1){ cart[idx].qty += 1; } else { cart.push(item); }
        setCart(cart);
        alert(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${name}`);
      });
    });

    function calcItemTotal(it){ return Math.round(it.price100 * (it.grams/100)) * it.qty; }

    function renderCart(){
      const tbody = D('#cartTable tbody'); if(!tbody) return;
      const cart = getCart();
      let total = 0;
      tbody.innerHTML = cart.map((it,i)=>{
        const line = calcItemTotal(it); total += line;
        return `<tr>
          <td style="padding:8px;border-bottom:1px solid #f2f2f2">${it.name}</td>
          <td style="padding:8px;border-bottom:1px solid #f2f2f2">${money(it.price100)}</td>
          <td style="padding:8px;border-bottom:1px solid #f2f2f2">${it.grams} Ã— ${it.qty}</td>
          <td style="padding:8px;border-bottom:1px solid #f2f2f2">${money(line)}</td>
          <td style="padding:8px;border-bottom:1px solid #f2f2f2"><button data-rm="${i}">âœ•</button></td>
        </tr>`
      }).join('');
      D('#cartTotal').textContent = money(total);

      // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø°Ù
      DA('button[data-rm]').forEach(b=>b.addEventListener('click',()=>{
        const cart = getCart(); cart.splice(parseInt(b.dataset.rm,10),1); setCart(cart);
      }));
    }

    // ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©
    D('#clearCart').addEventListener('click',()=> setCart([]));

    // Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Ù…Ø¬Ø±Ø¯ ØªØ£ÙƒÙŠØ¯)
    D('#checkoutCOD').addEventListener('click',()=>{
      const cart = getCart();
      if(!cart.length) return alert('Ø³Ù„ØªÙƒ ÙØ§Ø±ØºØ©');
      alert('ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ! Ø³Ù†ÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù„Ù„ØªØ£ÙƒÙŠØ¯.');
    });

    // Ø¥ØªÙ…Ø§Ù… Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³Ù„Ø©
    D('#checkoutWA').addEventListener('click',()=>{
      const cart = getCart();
      if(!cart.length) return alert('Ø³Ù„ØªÙƒ ÙØ§Ø±ØºØ©');
      const lines = cart.map(it=>`â€¢ ${it.name} â€” ${it.grams}Øº Ã— ${it.qty}`).join('
');
      const total = D('#cartTotal').textContent;
      const msg = `Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
${lines}
Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${total}`;
      const url = `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`;
      window.open(url,'_blank');
    });

    // Ø£ÙˆÙ„ Ø¹Ø±Ø¶
    renderCart();
  </script>
</body>
</html>
